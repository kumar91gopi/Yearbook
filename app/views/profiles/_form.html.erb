
      <%= form_for(@profile, html: {multipart: true}) do |f| %>
      <% if @profile.errors.any? %>
        <div id="error_explanation">
          <h2><%= pluralize(@profile.errors.count, "error") %> prohibited this profile from being saved:</h2>
    
          <ul>
          <% @profile.errors.full_messages.each do |message| %>
            <li><%= message %></li>
          <% end %>
          </ul>
        </div>
      <% end %>
    
      <div id="user_details">
        <h5 class="teal-text">User Details</h5>
        <!-- Basic user info-->
        <div class="upload-preview">
          <%= image_tag @profile.profile_pic.url, :alt => "Profile Picture", :class => "responsive-img materialboxed", :style=> "max-height:300px ; max-width: 300px;"%>
        </div>
        <div class="input-field">
          <%= f.file_field :profile_pic, :accept => 'image/jpeg,image/gif,image/png', :class => 'file'%>
          <br/>
        </div>
         <div class="input-field">
          <%= f.label :name %><br>
          <%= f.text_field :name %>
          <br/>
        </div>
        <!--School id and user type -->
        <% unless (@profile.school_id.nil? && @profile.user_type.nil?) %>
          <div class="field">
            <%= f.label :school_id %><br />
            <%= f.collection_select( :school_id, School.order(:school_name), :id, :school_name ,:include_blank => "Please select") %>
            <br/>
          </div>
          <div class="input-field">
            <%= f.select(:user_type, Profile.user_types.keys.map {|user_type| [user_type.titleize,user_type]}, :include_blank => "Please select") %>
            <br/>
          </div>
        <%end%>
        <!--end of school is and user type field-->
        <div class="input-field">
          <%= f.label :date_of_birth %><br />
          <%=f.date_field(:date_of_birth, :class => "datepicker", :include_blank => "Please select")%>
          <br/>
        </div>
        <div class="input-field">
          <%= f.radio_button :gender, "m"%>
          <%= f.label :gender_m, "Male" %>
          <%= f.radio_button :gender, "f" %>
          <%= f.label :gender_f, "Female" %>
          <br/>
        </div>
        <br/>
      </div>
      
      <!-- education info-->
      <div id="education_details">
        <h5 class="teal-text">Education</h5>
          <div class= "input-fields">
           <%= f.fields_for :educations, @educations do |ff|%>
             <%= render 'education_fields', :f => ff %>
           <%end%>
          </div>
           <div class= "links">
           <%= link_to_add_association 'add education', f, :educations %>
           </div>
      </div>
      
      <!-- Occupation info-->
      <div id="occupation_details">
        <h5 class="teal-text">Occupation</h5>
          <div class= "input-fields">
           <%= f.fields_for :occupations, @occupations do |ff|%>
             <%= render 'occupation_fields', :f => ff %>
           <%end%>
          </div>
          <div class= "links">
           <%= link_to_add_association 'Add occupation', f, :occupations %>
          </div>
      </div>
    
        
       
      <div id="other_info"> 
        <div class="field">
          <%= f.label :city %><br>
          <%= f.text_field :city %>
        </div>
        <div class="field">
          <%= f.label :about_me %><br>
          <%= f.text_area :about_me %>
        </div>
      </div>
      
      <div class="actions">
        <%= f.submit %>
      </div>
    <% end %>





<script type="text/javascript">
  $('#profile_profile_pic').bind('change', function() {
    var size_in_megabytes = this.files[0].size/1024/1024;
    if (size_in_megabytes > 3) {
      alert('Maximum file size is 3MB. Please choose a smaller file.');
    }
  });
  
  $(document).ready(function(){
    var preview = $(".upload-preview img");
    
    $(".file").change(function(event){
       var input = $(event.currentTarget);
       var file = input[0].files[0];
       var reader = new FileReader();
       reader.onload = function(e){
           image_base64 = e.target.result;
           preview.attr("src", image_base64);
       };
       reader.readAsDataURL(file);
    });
});
</script>
